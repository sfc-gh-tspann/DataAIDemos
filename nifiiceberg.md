#### Demo

#### S3 Stage for Storage Volume

````
  CREATE OR REPLACE EXTERNAL VOLUME transcom_tspanniceberg_extvol
   STORAGE_LOCATIONS =
      (
         (
            NAME = 'se-tspann-apacheiceberg'
            STORAGE_PROVIDER = 'S3'
            STORAGE_BASE_URL = 's3://se-tspann-apacheiceberg/'
            STORAGE_AWS_ROLE_ARN = 'arn:aws:iam::9999999999:role/se_tspann_iceberg_table_nifirole'
            STORAGE_AWS_EXTERNAL_ID = 'se_tspann_iceberg_table_external_id'
         )
      );

describe external volume transcom_tspanniceberg_extvol;

SELECT SYSTEM$VERIFY_EXTERNAL_VOLUME('transcom_tspanniceberg_extvol');

describe table icytranscome;

````

#### Iceberg Tables

````

create or replace ICEBERG TABLE DEMO.DEMO.ICYTRANSCOME (
	TITLE STRING,
	DESCRIPTION STRING,
	PUBDATE STRING,
	POINT STRING,
	LATITUDE STRING,
	TS STRING,
	LONGITUDE STRING,
	UUID STRING NOT NULL,
	primary key (UUID)
)
 EXTERNAL_VOLUME = 'TRANSCOM_TSPANNICEBERG_EXTVOL'
 CATALOG = 'SNOWFLAKE'
 BASE_LOCATION = 'transcom/';

create or replace ICEBERG TABLE ICYMTA (
	STOPPOINTREF STRING,
	VEHICLEREF STRING,
	PROGRESSRATE STRING,
	EXPECTEDDEPARTURETIME STRING,
	STOPPOINT STRING,
	VISITNUMBER STRING,
	DATAFRAMEREF STRING,
	STOPPOINTNAME STRING,
	SITUATIONSIMPLEREF5 STRING,
	SITUATIONSIMPLEREF3 STRING,
	BEARING STRING,
	SITUATIONSIMPLEREF4 STRING,
	SITUATIONSIMPLEREF1 STRING,
	ORIGINAIMEDDEPARTURETIME STRING,
	SITUATIONSIMPLEREF2 STRING,
	JOURNEYPATTERNREF STRING,
	RECORDEDATTIME STRING,
	OPERATORREF STRING,
	DESTINATIONNAME STRING,
	EXPECTEDARRIVALTIME STRING,
	BLOCKREF STRING,
	LINEREF STRING,
	VEHICLELOCATIONLONGITUDE STRING,
	DIRECTIONREF STRING,
	ARRIVALPROXIMITYTEXT STRING,
	DISTANCEFROMSTOP STRING,
	ESTIMATEDPASSENGERCAPACITY STRING,
	AIMEDARRIVALTIME STRING,
	PUBLISHEDLINENAME STRING,
	DATEDVEHICLEJOURNEYREF STRING,
	DATE STRING,
	MONITORED STRING,
	PROGRESSSTATUS STRING,
	DESTINATIONREF STRING,
	ESTIMATEDPASSENGERCOUNT STRING,
	VEHICLELOCATIONLATITUDE STRING,
	ORIGINREF STRING,
	NUMBEROFSTOPSAWAY STRING,
	TS STRING,
	UUID STRING
)
 EXTERNAL_VOLUME = 'TRANSCOM_TSPANNICEBERG_EXTVOL'
 CATALOG = 'SNOWFLAKE'
 BASE_LOCATION = 'mta/';

create or replace ICEBERG TABLE SERVICEALERTS (
	ROUTEID4 STRING,
	ROUTEID5 STRING,
	DESCRIPTIONLANG STRING,
	CAUSE STRING,
	STOPID STRING,
	ALERTLANG STRING,
	ALERTTEXT STRING,
	ROUTEID STRING,
	EFFECT STRING,
	STOPID5 STRING,
	DESCRIPTIONTEXT STRING,
	STOPID4 STRING,
	ACTIVEPERIODEND STRING,
	STOPID3 STRING,
	STOPID2 STRING,
	ROUTEID2 STRING,
	ROUTEID3 STRING,
	ACTIVEPERIODSTART STRING,
	TS STRING,
	UUID STRING
)
 EXTERNAL_VOLUME = 'TRANSCOM_TSPANNICEBERG_EXTVOL'
 CATALOG = 'SNOWFLAKE'
 BASE_LOCATION = 'subwayalerts/';

create or replace ICEBERG TABLE SUBWAY (
	STOPSEQUENCE STRING,
	ARRIVALTIME STRING,
	STOPID STRING,
	TRIPID STRING,
	TRIPSTARTDATE STRING,
	DEPARTURETIME STRING,
	TRIPROUTEID STRING,
	TS STRING,
	UUID STRING
)
 EXTERNAL_VOLUME = 'TRANSCOM_TSPANNICEBERG_EXTVOL'
 CATALOG = 'SNOWFLAKE'
 BASE_LOCATION = 'subway/';

create or replace ICEBERG TABLE VEHICLEPOSITIONS (
	ROUTE_ID STRING,
	BEARING STRING,
	DIRECTIONID STRING,
	LATITUDE STRING,
	TRIPID STRING,
	VEHICLELABEL STRING,
	VEHICLEID STRING,
	STARTDATE STRING,
	UUID STRING,
	SPEED STRING,
	LONGITUDE STRING,
	TIMESTAMP STRING,
	TS STRING
)
 EXTERNAL_VOLUME = 'TRANSCOM_TSPANNICEBERG_EXTVOL'
 CATALOG = 'SNOWFLAKE'
 BASE_LOCATION = 'subwayvp/';

  CREATE OR REPLACE ICEBERG TABLE STOCKVALUES (
	UUID STRING,
	LASTPRICE FLOAT,
	STOCKVOLUME FLOAT,
	SYMBOL STRING,
	TS STRING, 
	TRADECONDITIONS STRING
        )
  CATALOG = 'SNOWFLAKE'
  EXTERNAL_VOLUME = 'transcom_tspanniceberg_extvol'
  BASE_LOCATION = 'stocks';


CREATE ICEBERG TABLE ICYMTA (
   StopPointRef               STRING
  ,VehicleRef                 STRING
  ,ProgressRate               STRING
  ,ExpectedDepartureTime      STRING
  ,StopPoint                  STRING
  ,VisitNumber                STRING
  ,DataFrameRef               STRING
  ,StopPointName              STRING
  ,SituationSimpleRef5        STRING
  ,SituationSimpleRef3        STRING
  ,Bearing                    STRING
  ,SituationSimpleRef4        STRING
  ,SituationSimpleRef1        STRING
  ,OriginAimedDepartureTime   STRING
  ,SituationSimpleRef2        STRING
  ,JourneyPatternRef          STRING
  ,RecordedAtTime             STRING
  ,OperatorRef                STRING
  ,DestinationName            STRING
  ,ExpectedArrivalTime        STRING
  ,BlockRef                   STRING
  ,LineRef                    STRING
  ,VehicleLocationLongitude   STRING
  ,DirectionRef               STRING
  ,ArrivalProximityText       STRING
  ,DistanceFromStop           STRING
  ,EstimatedPassengerCapacity STRING
  ,AimedArrivalTime           STRING
  ,PublishedLineName          STRING
  ,DatedVehicleJourneyRef     STRING
  ,Date                       STRING
  ,Monitored                  STRING
  ,ProgressStatus             STRING
  ,DestinationRef             STRING
  ,EstimatedPassengerCount    STRING 
  ,VehicleLocationLatitude    STRING
  ,OriginRef                  STRING
  ,NumberOfStopsAway          STRING
  ,ts                         STRING
  ,uuid                       STRING
  )
  CATALOG = 'SNOWFLAKE'
  EXTERNAL_VOLUME = 'transcom_tspanniceberg_extvol'
  BASE_LOCATION = 'mta';


create or replace ICEBERG TABLE PLANES (
	SEEN_POS STRING,
	FLIGHT STRING,
	ADSBNOW STRING,
	LATITUDE STRING,
	NIC STRING,
	EMERGENCY STRING,
	UUID STRING,
	SEEN STRING,
	GEOMRATE STRING,
	NAVHEADING STRING,
	SILTYPE STRING,
	SQUAWK STRING,
	GVA STRING,
	BARORATE STRING,
	NOWTS STRING,
	SIL STRING,
	TRACK STRING,
	LONGITUDE STRING,
	MLAT STRING,
	NAVIGATIONACCURACYFORVELOCITY STRING,
	RSSI STRING,
	NAVICATIONINTEGRITYFORBAROMETRICALTITUDE STRING,
	NAVQNH STRING,
	GS STRING,
	DATAVERSION STRING,
	SDA STRING,
	RC STRING,
	NAVIGATIONACCURACYFORPOSITION STRING,
	TISB STRING,
	NAVALTITUDEMCP STRING,
	PLANEID STRING,
	MESSAGES STRING,
	CATEGORY STRING,
	ALTBARO STRING,
	TS STRING,
	ALTGEOM  STRING  )
  CATALOG = 'SNOWFLAKE'
  EXTERNAL_VOLUME = 'transcom_tspanniceberg_extvol'
  BASE_LOCATION = 'planes';

````
